jQuery((function(e){var t,a,r,n,o,i,s=(a=("https:"==location.protocol?"https:":"http:")+"//formoid.net/api/push",r=8==(t=(/MSIE (\d+)\./.exec(navigator.userAgent)||[0,0])[1])||9==t&&"file:"!=location.protocol?function(t,a){var r=new XDomainRequest,n=e.Deferred();return r.open(a.type,t),r.onload=function(){n.resolve(this.responseText)},r.onerror=function(){n.reject()},r.send(a.data),n}:(e.support.cors=!0,e.ajax),n=function(e,t){return e="__"+e+"__",t.length?(this[e]=t[0],this):this[e]},o=function(t,a,r){return e.each(r,(function(e,r){t[r]=function(){return a[r].apply(a,arguments)}})),t},(i=function(e){e=e||{},this.__email__=e.email||"",this.__title__=e.title||"",this.__data__=e.data||[]}).prototype.email=function(e){return n.call(this,"email",arguments)},i.prototype.title=function(e){return n.call(this,"title",arguments)},i.prototype.data=function(e){return n.call(this,"data",arguments)},i.prototype.send=function(t,n){var i=o(e.Deferred(),this,["email","title","data","send"]);return n&&(n.call(this,i),"pending"!=i.state())||r(a,{type:"POST",data:JSON.stringify({email:this.__email__,form:{title:this.__title__,data:arguments.length?t:this.__data__}})}).done((function(e){try{var t=JSON.parse(e);t.error?i.reject(t.error):i.resolve(t.response)}catch(e){i.reject("Incorrect server response.")}})).fail((function(){var e="Failed to query the server. ";"onLine"in navigator&&!navigator.onLine?e+="No connection to the Internet.":e+="Check the connection and try again.",i.reject(e)})),i},{Form:function(e){return new i(e)}}),l=function(t){var a=!0,r=e(t).val();return r&&(a=/^([^@]+?)@(([a-z0-9]-*)*[a-z0-9]+\.)+([a-z0-9]+)$/i.test(r)),a};e('[data-form-type="formoid"]').each((function(){var t,a=e(this),r=a.is("form")?a:a.find("form"),n=a.find("[data-form-alert]"),o=a.is("[data-form-title]")?a:a.find("[data-form-title]"),i=a.find('[type="submit"]'),d=r.find("[data-form-field]"),c=n.html();r.change((function(e){"file"===e.target.type&&e.target.files[0].size>1e6&&(n.removeAttr("hidden"),n.removeClass("alert-success").addClass("alert-danger"),n.html("File size must be less than 1mb"),i.addClass("btn-loading").prop("disabled",!0))})),d.each((function(t,a){e(a).on("focus",(function(){n.attr("hidden","hidden"),n.addClass("alert-success").removeClass("alert-danger"),n.html(""),i.removeClass("btn-loading").prop("disabled",!1)}))})),r.submit((function(f){if(f.preventDefault(),!i.hasClass("btn-loading")){var u=[],h=d;r.addClass("form-active"),i.addClass("btn-loading").prop("disabled",!0),n.html(""),t=t||s.Form({email:a.find("[data-form-email]").val(),title:o.attr("data-form-title")||o.text()}),function(t){var a=e.Deferred(),r=[];return t.each((function(t,o){var s=e(o),d=s.attr("type"),c=e.Deferred();if(r.push(c),"email"===s.attr("name")&&!l(o))return i.removeClass("btn-loading").prop("disabled",!0),a.reject(new Error("Form is not valid")),!1;switch(d){case"file":var f=new FileReader,h=s.attr("data-form-field")||s.attr("name"),m=s[0].files[0];f.onloadend=function(){u.push([h,f.result]),c.resolve()},f.onerror=function(){n.html(f.error),a.reject(f.error)},m&&f.readAsDataURL(m);break;case"checkbox":u.push([s.attr("data-form-field")||s.attr("name"),s.prop("checked")?s.val():"No"]),c.resolve();break;case"radio":s.prop("checked")&&(u.push([s.attr("data-form-field")||s.attr("name"),s.val()]),c.resolve());break;default:u.push([s.attr("data-form-field")||s.attr("name"),s.val()]),c.resolve()}})),a.resolve(r)}(h).then((function(a){e.when.apply(this,a).then((function(){t.send(u).always((function(){i.removeClass("btn-loading").prop("disabled",!1),n.removeAttr("hidden")})).then((function(t){h.each((function(){e(this).prop("checked")&&"checkbox"===e(this).attr("type")?e(this).removeAttr("checked"):e(this).val("")})),r.removeClass("form-active"),n.text(c||t),n.removeClass("alert-danger").addClass("alert-success")})).fail((function(e){n.text(e),n.removeClass("alert-success").addClass("alert-danger")}))}),(function(e){n.html(e.message),n.removeClass("alert-success").addClass("alert-danger"),n.removeAttr("hidden")}))}))}}))}))}));